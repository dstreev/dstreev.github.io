<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2024-08-21T13:28:12.769303"><title>Location Alignment | hms-mirror</title><script type="application/json" id="virtual-toc-data">[{"id":"order-of-evaluation","level":0,"title":"Order of Evaluation","anchor":"#order-of-evaluation"},{"id":"translation-types","level":0,"title":"Translation Types","anchor":"#translation-types"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Location Alignment | hms-mirror"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="hms-mirror Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/hms-mirror/v2.2.0.x/location-alignment.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Location Alignment | hms-mirror"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/hms-mirror/v2.2.0.x/location-alignment.html#webpage",
    "url": "writerside-documentation/hms-mirror/v2.2.0.x/location-alignment.html",
    "name": "Location Alignment | hms-mirror",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/hms-mirror/#website",
    "url": "writerside-documentation/hms-mirror/",
    "name": "hms-mirror Help"
}</script><!-- End Schema.org --></head><body data-id="Location-Alignment" data-main-title="Location Alignment" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>hms-mirror v2.2.0.x Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Location-Alignment" id="Location-Alignment.md">Location Alignment</h1><p id="knn0g9_3">In the Hive Metastore, Database definitions, Table Schemas, and Partition details include the location of their datasets. These locations contain a full URI to the dataset. Migrating from one cluster to another requires us to make adjustments to these locations.</p><figure id="knn0g9_4"><img alt="datamovement_strategy.png" src="images/datamovement_strategy.png" title="datamovement_strategy.png" width="1150" height="920"></figure><p id="knn0g9_5">The most simple translation will change the namespace of the URI so everything is RELATIVE. This helps reduce the impact of other tools that might be using these datasets outside the Hive Metastore definitions.</p><p id="knn0g9_6">Using the <code class="code" id="knn0g9_17">RELATIVE</code> 'Location Translation Strategy' is suggested for side-car cluster migrations where you want to keep everything the same as much as possible.</p><p id="knn0g9_7">When you are reorganizing, consolidating, or changing storage environments then the <code class="code" id="knn0g9_18">ALIGNED</code> 'Location Translation Strategy' will aid in that process. We suggest building out <a href="warehouse-plans.html" id="knn0g9_19" data-tooltip="Warehouse Plans are the way you can control how 'each' Database is translated between clusters or storage environments. Warehouse plans allow you to control where the data will be translated to.">Warehouse Plans</a> for each database for maximum control of that movement.</p><p id="knn0g9_8">Attributes of location transformations:</p><ul class="list _bullet" id="knn0g9_9"><li class="list__item" id="knn0g9_20"><p>Global Warehouse Directories</p></li><li class="list__item" id="knn0g9_21"><p>Environment Warehouse Directories</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="knn0g9_10"><p id="knn0g9_22">These are pulling automatically from the Hive Environment when available.</p></aside><ul class="list _bullet" id="knn0g9_11"><li class="list__item" id="knn0g9_23"><p>Target Namespace</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="knn0g9_12"><p id="knn0g9_24">This is defined in the configuration through the <code class="code" id="knn0g9_25">transfer.targetNamespace</code> configuration attribute or the <code class="code" id="knn0g9_26">target-namespace</code> configuration setting. This is used for migrations between two clusters and for STORAGE_MIGRATION's within the cluster.</p></aside><ul class="list _bullet" id="knn0g9_13"><li class="list__item" id="knn0g9_27"><p>Warehouse Plans</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="knn0g9_14"><p id="knn0g9_28">Defined for each 'database'. And when defined we should assume that we expect locations of the database, tables, and partitions will be ALIGNED with that location.</p></aside><section class="chapter"><h2 id="order-of-evaluation" data-toc="order-of-evaluation">Order of Evaluation</h2><p id="knn0g9_29">Order of Evaluation means that we will evaluate the attribute in the describe order and once a valid mapping is found, we will stop the evaluation. Evaluation order depends on the translation type as well.</p><div class="tabs" id="knn0g9_30" data-anchors="[aligned-tab,relative-tab]"><div class="tabs__content" data-gtm="tab" id="aligned-tab" data-title="ALIGNED"><ul class="list _bullet" id="knn0g9_33"><li class="list__item" id="knn0g9_34"><p>Target Namespace</p></li><li class="list__item" id="knn0g9_35"><p>Warehouse Plans (when defined)</p></li><li class="list__item" id="knn0g9_36"><p>Global Warehouse Directories</p></li><li class="list__item" id="knn0g9_37"><p>Environment Warehouse Directories (under certain conditions)</p></li></ul></div><div class="tabs__content" data-gtm="tab" id="relative-tab" data-title="RELATIVE"><ul class="list _bullet" id="knn0g9_38"><li class="list__item" id="knn0g9_39"><p>Target Namespace</p></li></ul></div></div></section><section class="chapter"><h2 id="translation-types" data-toc="translation-types">Translation Types</h2><p id="knn0g9_40">Translation types are used to determine how the location should be transformed. The following are the translation types are <code class="code" id="knn0g9_45">ALIGNED</code> and <code class="code" id="knn0g9_46">RELATIVE</code>.</p><p id="knn0g9_41"><span class="control" id="knn0g9_47">Legend</span></p><div class="table-wrapper"><table class="wide" id="knn0g9_42"><thead><tr class="ijRowHead" id="knn0g9_48"><th id="knn0g9_60"><p>Icon</p></th><th id="knn0g9_61"><p>Description</p></th></tr></thead><tbody><tr id="knn0g9_49"><td id="knn0g9_62"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_64" width="30" height="30"></p></td><td id="knn0g9_63"><p>Valid</p></td></tr><tr id="knn0g9_50"><td id="knn0g9_65"><p><img alt="Close round" src="images/closeRound.png" class="inline-icon-" title="Close round" id="knn0g9_67" width="30" height="30"></p></td><td id="knn0g9_66"><p>Invalid</p></td></tr><tr id="knn0g9_51"><td id="knn0g9_68"><p><img alt="Ignored" src="images/ignored.png" class="inline-icon-" title="Ignored" id="knn0g9_70" width="30" height="30"></p></td><td id="knn0g9_69"><p>Ignored</p></td></tr><tr id="knn0g9_52"><td id="knn0g9_71"><p><img alt="Sql icon" src="images/sql-icon.png" class="inline-icon-" title="Sql icon" id="knn0g9_73" width="20" height="20"></p></td><td id="knn0g9_72"><p>SQL</p></td></tr><tr id="knn0g9_53"><td id="knn0g9_74"><p><img alt="Files o copy" src="images/files-o-copy.png" class="inline-icon-" title="Files o copy" id="knn0g9_76" width="20" height="20"></p></td><td id="knn0g9_75"><p>Distcp</p></td></tr><tr id="knn0g9_54"><td id="knn0g9_77"><p><img alt="Person" src="images/person.png" class="inline-icon-" title="Person" id="knn0g9_79" width="20" height="20"></p></td><td id="knn0g9_78"><p>Manual</p></td></tr><tr id="knn0g9_55"><td id="knn0g9_80"><p><img alt="Typcn arrow sync" src="images/typcn-arrow-sync.png" class="inline-icon-" title="Typcn arrow sync" id="knn0g9_82" width="20" height="20"></p></td><td id="knn0g9_81"><p>Automatic</p></td></tr><tr id="knn0g9_56"><td id="knn0g9_83"><p><img alt="Optional" src="images/optional.jpg" class="inline-icon-" title="Optional" id="knn0g9_85" width="20" height="20"></p></td><td id="knn0g9_84"><p>Optional</p></td></tr><tr id="knn0g9_57"><td id="knn0g9_86"><p><img alt="Linecons database" src="images/linecons-database.png" class="inline-icon-" title="Linecons database" id="knn0g9_88" width="20" height="20"></p></td><td id="knn0g9_87"><p>Metastore Direct</p></td></tr><tr id="knn0g9_58"><td id="knn0g9_89"><p><img alt="Typcn world" src="images/typcn-world.png" class="inline-icon-" title="Typcn world" id="knn0g9_91" width="20" height="20"></p></td><td id="knn0g9_90"><p>Global Warehouse</p></td></tr><tr id="knn0g9_59"><td id="knn0g9_92"><p><img alt="Linea basic elaboration document next" src="images/linea--basic-elaboration-document-next.png" class="inline-icon-" title="Linea basic elaboration document next" id="knn0g9_94" width="20" height="20"></p></td><td id="knn0g9_93"><p>Warehouse Plan</p></td></tr></tbody></table></div><p id="knn0g9_43"><span class="control" id="knn0g9_95">Translation Scenarios</span></p><div class="table-wrapper"><table class="left_header wide" id="knn0g9_44"><thead><tr class="ijRowHead" id="knn0g9_96"><th id="knn0g9_113"></th><th id="knn0g9_114" colspan="2"><p>Translation Type</p></th><th id="knn0g9_115"><p>Data</p><br><p> Movement</p></th><th id="knn0g9_116"><p>Required</p></th><th id="knn0g9_117"><p>Notes</p></th></tr></thead><tbody><tr id="knn0g9_97"><th id="knn0g9_119"><p>DUMP</p></th><td id="knn0g9_120"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_125" width="30" height="30"></p></td><td id="knn0g9_121"><p id="knn0g9_126">RELATIVE</p></td><td id="knn0g9_122"></td><td id="knn0g9_123"></td><td id="knn0g9_124"></td></tr><tr id="knn0g9_98"><th id="knn0g9_127"></th><td id="knn0g9_128"><p><img alt="Close round" src="images/closeRound.png" class="inline-icon-" title="Close round" id="knn0g9_133" width="30" height="30"></p></td><td id="knn0g9_129"><p id="knn0g9_134">ALIGNED</p></td><td id="knn0g9_130"></td><td id="knn0g9_131"></td><td id="knn0g9_132"></td></tr><tr id="knn0g9_99"><th id="knn0g9_135"><p>SCHEMA_ONLY</p></th><td id="knn0g9_136"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_141" width="30" height="30"></p></td><td id="knn0g9_137"><p id="knn0g9_142">RELATIVE</p></td><td id="knn0g9_138"><p id="knn0g9_143"><img alt="Files o copy" src="images/files-o-copy.png" class="inline-icon-" title="Files o copy" id="knn0g9_144" width="20" height="20"> <img alt="Person" src="images/person.png" class="inline-icon-" title="Person" id="knn0g9_145" width="20" height="20"></p></td><td id="knn0g9_139"></td><td id="knn0g9_140"><p><img alt="Typcn warning" src="images/typcn-warning.png" class="inline-icon-" title="Typcn warning" id="knn0g9_146" width="30" height="30"> Using distcp <img alt="Files o copy" src="images/files-o-copy.png" class="inline-icon-" title="Files o copy" id="knn0g9_147" width="20" height="20"> here when either table or partition locations aren't standard, will result in data loss because we're not inspecting all the locations through the Metastore Direct connection. It's recommended to use `ALIGNED` with `distcp` to build an accurate `distcp` plan.</p></td></tr><tr id="knn0g9_100"><th id="knn0g9_148"></th><td id="knn0g9_149"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_154" width="30" height="30"></p></td><td id="knn0g9_150"><p id="knn0g9_155">ALIGNED</p></td><td id="knn0g9_151"><p><img alt="Files o copy" src="images/files-o-copy.png" class="inline-icon-" title="Files o copy" id="knn0g9_156" width="20" height="20"></p></td><td id="knn0g9_152"><p id="knn0g9_157"><img alt="Linecons database" src="images/linecons-database.png" class="inline-icon-" title="Linecons database" id="knn0g9_158" width="20" height="20"> when Warehouse Plan(s) used<br> <img alt="Typcn world" src="images/typcn-world.png" class="inline-icon-" title="Typcn world" id="knn0g9_160" width="20" height="20"><br> <img alt="Linea basic elaboration document next" src="images/linea--basic-elaboration-document-next.png" class="inline-icon-" title="Linea basic elaboration document next" id="knn0g9_162" width="20" height="20"> (Optional)</p></td><td id="knn0g9_153"></td></tr><tr id="knn0g9_101"><th id="knn0g9_163"><p>SQL</p></th><td id="knn0g9_164"><p><img alt="Close round" src="images/closeRound.png" class="inline-icon-" title="Close round" id="knn0g9_169" width="30" height="30"></p></td><td id="knn0g9_165"><p id="knn0g9_170">RELATIVE</p></td><td id="knn0g9_166"></td><td id="knn0g9_167"></td><td id="knn0g9_168"></td></tr><tr id="knn0g9_102"><th id="knn0g9_171"></th><td id="knn0g9_172"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_177" width="30" height="30"></p></td><td id="knn0g9_173"><p id="knn0g9_178">ALIGNED</p></td><td id="knn0g9_174"><p id="knn0g9_179"><img alt="Sql icon" src="images/sql-icon.png" class="inline-icon-" title="Sql icon" id="knn0g9_180" width="20" height="20"> <img alt="Files o copy" src="images/files-o-copy.png" class="inline-icon-" title="Files o copy" id="knn0g9_181" width="20" height="20"></p></td><td id="knn0g9_175"><p id="knn0g9_182"><img alt="Typcn world" src="images/typcn-world.png" class="inline-icon-" title="Typcn world" id="knn0g9_183" width="20" height="20"><br> <img alt="Linea basic elaboration document next" src="images/linea--basic-elaboration-document-next.png" class="inline-icon-" title="Linea basic elaboration document next" id="knn0g9_185" width="20" height="20"> (Optional)</p></td><td id="knn0g9_176"></td></tr><tr id="knn0g9_103"><th id="knn0g9_186"><p>EXPORT_IMPORT</p></th><td id="knn0g9_187"><p><img alt="Close round" src="images/closeRound.png" class="inline-icon-" title="Close round" id="knn0g9_192" width="30" height="30"></p></td><td id="knn0g9_188"><p id="knn0g9_193">RELATIVE</p></td><td id="knn0g9_189"></td><td id="knn0g9_190"></td><td id="knn0g9_191"></td></tr><tr id="knn0g9_104"><th id="knn0g9_194"></th><td id="knn0g9_195"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_200" width="30" height="30"></p></td><td id="knn0g9_196"><p id="knn0g9_201">ALIGNED</p></td><td id="knn0g9_197"><p><img alt="Typcn arrow sync" src="images/typcn-arrow-sync.png" class="inline-icon-" title="Typcn arrow sync" id="knn0g9_202" width="20" height="20"></p></td><td id="knn0g9_198"><p id="knn0g9_203"><img alt="Typcn world" src="images/typcn-world.png" class="inline-icon-" title="Typcn world" id="knn0g9_204" width="20" height="20"><br> <img alt="Linea basic elaboration document next" src="images/linea--basic-elaboration-document-next.png" class="inline-icon-" title="Linea basic elaboration document next" id="knn0g9_206" width="20" height="20"> (Optional)</p></td><td id="knn0g9_199"></td></tr><tr id="knn0g9_105"><th id="knn0g9_207"><p>HYBRID</p></th><td id="knn0g9_208"><p><img alt="Close round" src="images/closeRound.png" class="inline-icon-" title="Close round" id="knn0g9_213" width="30" height="30"></p></td><td id="knn0g9_209"><p id="knn0g9_214">RELATIVE</p></td><td id="knn0g9_210"></td><td id="knn0g9_211"></td><td id="knn0g9_212"></td></tr><tr id="knn0g9_106"><th id="knn0g9_215"></th><td id="knn0g9_216"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_221" width="30" height="30"></p></td><td id="knn0g9_217"><p id="knn0g9_222">ALIGNED</p></td><td id="knn0g9_218"><p><img alt="Sql icon" src="images/sql-icon.png" class="inline-icon-" title="Sql icon" id="knn0g9_223" width="20" height="20"></p></td><td id="knn0g9_219"><p id="knn0g9_224"><img alt="Typcn world" src="images/typcn-world.png" class="inline-icon-" title="Typcn world" id="knn0g9_225" width="20" height="20"><br> <img alt="Linea basic elaboration document next" src="images/linea--basic-elaboration-document-next.png" class="inline-icon-" title="Linea basic elaboration document next" id="knn0g9_227" width="20" height="20"> (Optional)</p></td><td id="knn0g9_220"></td></tr><tr id="knn0g9_107"><th id="knn0g9_228"><p>STORAGE_MIGRATION</p></th><td id="knn0g9_229"><p><img alt="Close round" src="images/closeRound.png" class="inline-icon-" title="Close round" id="knn0g9_234" width="30" height="30"></p></td><td id="knn0g9_230"><p id="knn0g9_235">RELATIVE</p></td><td id="knn0g9_231"></td><td id="knn0g9_232"></td><td id="knn0g9_233"></td></tr><tr id="knn0g9_108"><th id="knn0g9_236"></th><td id="knn0g9_237"><p><img alt="Checkmark round" src="images/checkmarkRound.png" class="inline-icon-" title="Checkmark round" id="knn0g9_243" width="30" height="30"></p></td><td id="knn0g9_238"><p id="knn0g9_244">ALIGNED</p></td><td id="knn0g9_239"><p id="knn0g9_245"><img alt="Sql icon" src="images/sql-icon.png" class="inline-icon-" title="Sql icon" id="knn0g9_246" width="20" height="20"> <img alt="Files o copy" src="images/files-o-copy.png" class="inline-icon-" title="Files o copy" id="knn0g9_247" width="20" height="20"></p></td><td id="knn0g9_240"><p id="knn0g9_248"><img alt="Linecons database" src="images/linecons-database.png" class="inline-icon-" title="Linecons database" id="knn0g9_249" width="20" height="20"> when Warehouse Plan(s) used<br> <img alt="Linea basic elaboration document next" src="images/linea--basic-elaboration-document-next.png" class="inline-icon-" title="Linea basic elaboration document next" id="knn0g9_251" width="20" height="20"> (Optional)</p></td><td id="knn0g9_241"></td><td id="knn0g9_242"></td></tr><tr id="knn0g9_109"><th id="knn0g9_252"><p>LINKED</p></th><td id="knn0g9_253"><p><img alt="Ignored" src="images/ignored.png" class="inline-icon-" title="Ignored" id="knn0g9_258" width="30" height="30"></p></td><td id="knn0g9_254"><p id="knn0g9_259">RELATIVE</p></td><td id="knn0g9_255"></td><td id="knn0g9_256"></td><td id="knn0g9_257"></td></tr><tr id="knn0g9_110"><th id="knn0g9_260"></th><td id="knn0g9_261"><p><img alt="Ignored" src="images/ignored.png" class="inline-icon-" title="Ignored" id="knn0g9_266" width="30" height="30"></p></td><td id="knn0g9_262"><p id="knn0g9_267">ALIGNED</p></td><td id="knn0g9_263"></td><td id="knn0g9_264"></td><td id="knn0g9_265"></td></tr><tr id="knn0g9_111"><th id="knn0g9_268"><p>COMMON</p></th><td id="knn0g9_269"><p><img alt="Ignored" src="images/ignored.png" class="inline-icon-" title="Ignored" id="knn0g9_274" width="30" height="30"></p></td><td id="knn0g9_270"><p id="knn0g9_275">RELATIVE</p></td><td id="knn0g9_271"></td><td id="knn0g9_272"></td><td id="knn0g9_273"></td></tr><tr id="knn0g9_112"><th id="knn0g9_276"></th><td id="knn0g9_277"><p><img alt="Ignored" src="images/ignored.png" class="inline-icon-" title="Ignored" id="knn0g9_282" width="30" height="30"></p></td><td id="knn0g9_278"><p id="knn0g9_283">ALIGNED</p></td><td id="knn0g9_279"></td><td id="knn0g9_280"></td><td id="knn0g9_281"></td></tr></tbody></table></div></section><div class="last-modified">Last modified: 21 August 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="hms-mirror-tips.html" class="navigation-links__prev">Tips</a><a href="databases.html" class="navigation-links__next">Databases</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.js"></script></body></html>