<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2024-04-26T11:20:32.065436"><title>Setup | hms-mirror</title><script type="application/json" id="virtual-toc-data">[{"id":"left-and-right-clusters","level":0,"title":"LEFT and RIGHT Clusters","anchor":"#left-and-right-clusters"},{"id":"binary-package","level":0,"title":"Binary Package","anchor":"#binary-package"},{"id":"hms-mirror-setup-from-binary-distribution","level":0,"title":"HMS-Mirror Setup from Binary Distribution","anchor":"#hms-mirror-setup-from-binary-distribution"},{"id":"quick-start","level":0,"title":"Quick Start","anchor":"#quick-start"},{"id":"general-guidance","level":0,"title":"General Guidance","anchor":"#general-guidance"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Setup | hms-mirror"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="hms-mirror Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/hms-mirror/v2.x/hms-mirror-setup.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Setup | hms-mirror"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/hms-mirror/v2.x/hms-mirror-setup.html#webpage",
    "url": "writerside-documentation/hms-mirror/v2.x/hms-mirror-setup.html",
    "name": "Setup | hms-mirror",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/hms-mirror/#website",
    "url": "writerside-documentation/hms-mirror/",
    "name": "hms-mirror Help"
}</script><!-- End Schema.org --></head><body data-id="hms-mirror-setup" data-main-title="Setup" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>hms-mirror v2.x Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="hms-mirror-setup" id="hms-mirror-setup.md">Setup</h1><section class="chapter"><h2 id="left-and-right-clusters" data-toc="left-and-right-clusters">LEFT and RIGHT Clusters</h2><p id="y03ix6_72"><code class="code" id="y03ix6_73">hms-mirror</code> defines clusters as LEFT and RIGHT. The LEFT cluster is the source of the metadata and the RIGHT cluster is the target. The LEFT cluster is usually the older cluster version. Regardless, under specific scenario's, <code class="code" id="y03ix6_74">hms-mirror</code> will use an HDFS client to check directories and move small amounts of data (AVRO schema files). <code class="code" id="y03ix6_75">hms-mirror</code> will depend on the configuration of the node it's running on to locate the 'hcfs filesystem'. This means that the <code class="code" id="y03ix6_76">/etc/hadoop/conf</code> directory should contain all the environments settings to successfully connect to <code class="code" id="y03ix6_77">hcfs (Hadoop Compatible File System</code>.</p></section><section class="chapter"><h2 id="binary-package" data-toc="binary-package">Binary Package</h2><p id="y03ix6_78"><a href="https://github.com/cloudera-labs/hms-mirror/releases" id="y03ix6_79" data-external="true" rel="noopener noreferrer">Download the latest version of <code class="code" id="y03ix6_80">hms-mirror-&lt;version&gt;-dist.tar.gz</code></a></p></section><section class="chapter"><h2 id="hms-mirror-setup-from-binary-distribution" data-toc="hms-mirror-setup-from-binary-distribution">HMS-Mirror Setup from Binary Distribution</h2><p id="y03ix6_81">On the edgenode:</p><ul class="list _bullet" id="y03ix6_82"><li class="list__item" id="y03ix6_83"><p id="y03ix6_84">Remove previous install directory <code class="code" id="y03ix6_85">rm -rf hms-mirror-install-&lt;version&gt;</code></p><ul class="list _bullet" id="y03ix6_86"><li class="list__item" id="y03ix6_87"><p>If you don't remove the previous install directory, the default <code class="code" id="y03ix6_88">tar</code> behaviour will NOT overwrite the existing directory, hence you won't get the new version.</p></li></ul></li><li class="list__item" id="y03ix6_89"><p id="y03ix6_90">Expand the tarball <code class="code" id="y03ix6_91">tar zxvf hms-mirror-&lt;version&gt;-dist.tar.gz</code>.</p><aside class="prompt" data-type="tip" data-title="" id="y03ix6_92"><p id="y03ix6_93">This produces a child <code class="code" id="y03ix6_94">hms-mirror-install-&lt;version&gt;</code> directory.</p></aside></li><li class="list__item" id="y03ix6_95"><p id="y03ix6_96">Two options for installation:</p><ul class="list _bullet" id="y03ix6_97"><li class="list__item" id="y03ix6_98"><p>As the root user (or <code class="code" id="y03ix6_99">sudo</code>), run <code class="code" id="y03ix6_100">hms-mirror-install-&lt;version&gt;/setup.sh</code>. This will install the <code class="code" id="y03ix6_101">hms-mirror</code> packages in <code class="code" id="y03ix6_102">/usr/local/hms-mirror</code> and create symlinks for the executables in <code class="code" id="y03ix6_103">/usr/local/bin</code>. At this point, <code class="code" id="y03ix6_104">hms-mirror</code> should be available to all user and in the default path.</p></li><li class="list__item" id="y03ix6_105"><p>As the local user, run <code class="code" id="y03ix6_106">hms-mirror-install-&lt;version&gt;/setup.sh</code>. This will install the <code class="code" id="y03ix6_107">hms-mirror</code> packages in <code class="code" id="y03ix6_108">$HOME/.hms-mirror</code> and create symlink in <code class="code" id="y03ix6_109">$HOME/bin</code>. Ensure <code class="code" id="y03ix6_110">$HOME/bin</code> is in the users path and run <code class="code" id="y03ix6_111">hms-mirror</code>.</p></li></ul></li></ul><p id="y03ix6_112"><span class="emphasis" id="y03ix6_113">DO NOT RUN <code class="code" id="y03ix6_114">hms-mirror</code> from the installation directory.</span></p><p id="y03ix6_115">If you install both options, your environment PATH will determine which one is run. Make note of this because an upgrade may not be reachable.</p></section><section class="chapter"><h2 id="quick-start" data-toc="quick-start">Quick Start</h2><p id="y03ix6_116"><code class="code" id="y03ix6_117">hms-mirror</code> requires a configuration file describing the LEFT (source) and RIGHT (target) cluster connections. There are two ways to create the config:</p><ul class="list _bullet" id="y03ix6_118"><li class="list__item" id="y03ix6_119"><p>Use the <a href="hms-mirror-default-configuration-template.html" id="y03ix6_120" data-tooltip="Default Configuration Template # Copyright 2021 Cloudera, Inc. All Rights Reserved. # # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # #â€¦">default config template</a>) as a starting point. Edit and place a copy here <code class="code" id="y03ix6_121">$HOME/.hms-mirror/cfg/default.yaml</code>.</p></li><li class="list__item" id="y03ix6_122"><p><code class="code" id="y03ix6_123">hms-mirror --setup</code> - Prompts a series of questions about the LEFT and RIGHT clusters to build the default configuration file.</p></li></ul><p id="y03ix6_124">If either or both clusters are Kerberized, please review the detailed configuration guidance <a href="hms-mirror-running.html#running-against-a-legacy-non-cdp-kerberized-hiveserver2" id="y03ix6_125" data-tooltip="hms-mirror is pre-built with CDP libraries and WILL NOT be compatible with LEGACY kerberos environments. A Kerberos connection can only be made to ONE cluster when the clusters are NOT running the same 'major' version of Hadoop.">here</a> and <a href="hms-mirror-running.html#kerberized-connections" id="y03ix6_126" data-tooltip="hms-mirror relies on the Hadoop libraries to connect via 'kerberos'. Suppose the clusters are running different versions of Hadoop/Hive. In that case, we can only support connecting to one of the clusters via Kerberos. While hms-mirror is built with the dependencies for Hadoop 3.1â€¦">here</a>.</p></section><section class="chapter"><h2 id="general-guidance" data-toc="general-guidance">General Guidance</h2><ul class="list _bullet" id="y03ix6_127"><li class="list__item" id="y03ix6_128"><p>Run <code class="code" id="y03ix6_129">hms-mirror</code> from the RIGHT cluster on an Edge Node.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="y03ix6_130"><p id="y03ix6_131"><code class="code" id="y03ix6_132">hms-mirror</code> is built (default setting) with CDP libraries and will connect natively using those libraries. The edge node should have the hdfs client installed and configured for that cluster. The application will use this connection for some migration strategies.</p></aside><ul class="list _bullet" id="y03ix6_133"><li class="list__item" id="y03ix6_134"><p>If running from the LEFT cluster, note that the <code class="code" id="y03ix6_135">-ro/--read-only</code> feature examines HDFS on the RIGHT cluster. The HDFS client on the LEFT cluster may not support this access.</p></li><li class="list__item" id="y03ix6_136"><p>Connecting to HS2 through KNOX (in both clusters, if possible) reduces the complexities of the connection by removing Kerberos from the picture.</p></li><li class="list__item" id="y03ix6_137"><p>The libraries will only support a Kerberos connection to a 'single' version of Hadoop at a time. This is relevant for 'Kerberized' connections to Hive Server 2. The default libraries will support a kerberized connection to a CDP clusters HS2 and HDFS. If the LEFT (source) cluster is Kerberized, including HS2, you will need to make some adjustments. </p><ul class="list _bullet" id="y03ix6_138"><li class="list__item" id="y03ix6_139"><p>The LEFT clusters HS2 needs to support any auth mechanism BUT Kerberos.</p></li><li class="list__item" id="y03ix6_140"><p>Use an Ambari Group to setup an independent HS2 instance for this exercise or use KNOX.</p></li></ul></li></ul></section><div class="last-modified">Last modified: 26 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="linking-cluster-storage-layers.html" class="navigation-links__prev">Linking Cluster Storage Layers</a><a href="hms-mirror-cfg.html" class="navigation-links__next">Configuration</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.js"></script></body></html>