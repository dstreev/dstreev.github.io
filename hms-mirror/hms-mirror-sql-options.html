<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2024-08-16T16:47:12.16946"><title>Options | hms-mirror</title><script type="application/json" id="virtual-toc-data">[{"id":"sp-sql-partition-count-limit","level":0,"title":"-sp,--sql-partition-count \u003climit\u003e","anchor":"#sp-sql-partition-count-limit"},{"id":"ma-migrate-acid-or-mao-migrate-acid-only","level":0,"title":"-ma|--migrate-acid or -mao|--migrate-acid-only","anchor":"#ma-migrate-acid-or-mao-migrate-acid-only"},{"id":"da-downgrade-acid","level":0,"title":"-da|--downgrade-acid","anchor":"#da-downgrade-acid"},{"id":"dc-distcp","level":0,"title":"-dc|--distcp","anchor":"#dc-distcp"},{"id":"is-intermediate-storage-or-cs-common-storage","level":0,"title":"-is|--intermediate-storage or -cs|--common-storage","anchor":"#is-intermediate-storage-or-cs-common-storage"},{"id":"wd-warehouse-directory-and-ewd-external-warehouse-directory","level":0,"title":"-wd|--warehouse-directory and -ewd|--external-warehouse-directory","anchor":"#wd-warehouse-directory-and-ewd-external-warehouse-directory"},{"id":"rdl-reset-to-default-location","level":0,"title":"-rdl|--reset-to-default-location","anchor":"#rdl-reset-to-default-location"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Options | hms-mirror"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="hms-mirror Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/hms-mirror/v2.2.0.x/hms-mirror-sql-options.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Options | hms-mirror"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/hms-mirror/v2.2.0.x/hms-mirror-sql-options.html#webpage",
    "url": "writerside-documentation/hms-mirror/v2.2.0.x/hms-mirror-sql-options.html",
    "name": "Options | hms-mirror",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/hms-mirror/#website",
    "url": "writerside-documentation/hms-mirror/",
    "name": "hms-mirror Help"
}</script><!-- End Schema.org --></head><body data-id="hms-mirror-sql-options" data-main-title="Options" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Strategies.md|Strategies///SQL.md|SQL"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>hms-mirror v2.2.0.x Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="hms-mirror-sql-options" id="hms-mirror-sql-options.md">Options</h1><p id="d0gna3_3">Use <code class="code" id="d0gna3_11">-ep|--export-partition-count &lt;limit&gt;</code> to set the limit for the number of partitions to use EXPORT_IMPORT. The default is 100. When a table has a partition count that exceeds this value, the <a href="sql.html" id="d0gna3_12" data-tooltip="The SQL data strategy will use Hive SQL to move data between clusters. When the cluster don't have direct line of sight to each other and can NOT be linked, you can use options like -cs or -is to bridge the gap.">SQL</a> strategy will be used.</p><section class="chapter"><h2 id="sp-sql-partition-count-limit" data-toc="sp-sql-partition-count-limit"><code class="code" id="d0gna3_17">-sp,--sql-partition-count &lt;limit&gt;</code></h2><p id="d0gna3_14">Sets the limit for the number of partitions that the <a href="sql.html" id="d0gna3_18" data-tooltip="The SQL data strategy will use Hive SQL to move data between clusters. When the cluster don't have direct line of sight to each other and can NOT be linked, you can use options like -cs or -is to bridge the gap.">SQL</a> strategy will process. If the value is exceeded, the process will NOT migrate the table. The default is 500 .</p><p id="d0gna3_15">To persist a higher value without specifying the <code class="code" id="d0gna3_19">-sp</code> option, add the following to the <a href="hms-mirror-default-configuration-template.html" id="d0gna3_20" data-tooltip="Use this as a template for the default.yaml configuration file used by the cli interface.">config</a>.</p><div class="code-block" data-lang="yaml">
hybrid:
  sqlPartitionLimit: &lt;limit&gt;
</div></section><section class="chapter"><h2 id="ma-migrate-acid-or-mao-migrate-acid-only" data-toc="ma-migrate-acid-or-mao-migrate-acid-only"><code class="code" id="d0gna3_23">-ma|--migrate-acid</code> or <code class="code" id="d0gna3_24">-mao|--migrate-acid-only</code></h2><p id="d0gna3_22">Include ACID tables in processing.</p></section><section class="chapter"><h2 id="da-downgrade-acid" data-toc="da-downgrade-acid"><code class="code" id="d0gna3_27">-da|--downgrade-acid</code></h2><p id="d0gna3_26">Applicable only when <code class="code" id="d0gna3_28">-ma|o</code> is used. This will take the ACID tables and downgrade them to <span class="emphasis" id="d0gna3_29">EXTERNAL/PURGE</span> tables. <a href="hms-mirror-features.html#acid-tables" id="d0gna3_30" data-tooltip="hms-mirror supports the migration of ACID tables using the -d HYBRID|SQL|EXPORT_IMPORT data strategy in combination with the -ma|--migrate-acid or -mao|--migrate-acid-only flag. You can also simply 'replay' the schema definition (without data) using -d SCHEMA_ONLY -ma|-mao. Theâ€¦">Buckets adjustments</a> are applicable.</p></section><section class="chapter"><h2 id="dc-distcp" data-toc="dc-distcp"><code class="code" id="d0gna3_36">-dc|--distcp</code></h2><p id="d0gna3_32">For EXTERNAL tables, this will build a <code class="code" id="d0gna3_37">distcp</code> plan that can be used to transfer the database tables.</p><p id="d0gna3_33">When the option <code class="code" id="d0gna3_38">-ma|o</code> is used, ACID tables will be migrated. <span class="emphasis" id="d0gna3_39">ACID</span> tables will be converted to EXTERNAL transfer tables for the <code class="code" id="d0gna3_40">distcp</code> operations. On the other cluster, the tables will be created initially as <span class="emphasis" id="d0gna3_41">EXTERNAL</span>, then transferred back over to <span class="emphasis" id="d0gna3_42">ACID</span> tables, unless <code class="code" id="d0gna3_43">-da</code> is used.</p><p id="d0gna3_34">If the <code class="code" id="d0gna3_44">-da</code> is used the tables will remain <span class="emphasis" id="d0gna3_45">EXTERNAL</span> on the new cluster.</p><p id="d0gna3_35">When <code class="code" id="d0gna3_46">-is</code> is used, there will be <code class="code" id="d0gna3_47">distcp</code> operations required on both clusters to handle data movement to/from the <code class="code" id="d0gna3_48">intermediate-storage</code> area.</p></section><section class="chapter"><h2 id="is-intermediate-storage-or-cs-common-storage" data-toc="is-intermediate-storage-or-cs-common-storage"><code class="code" id="d0gna3_54">-is|--intermediate-storage</code> or <code class="code" id="d0gna3_55">-cs|--common-storage</code></h2><p id="d0gna3_50">When the clusters aren't <a href="linking-cluster-storage-layers.html" id="d0gna3_56" data-tooltip="For the hms-mirror process to work, it relies on the RIGHT clusters' ability to SEE and ACCESS data in the LEFT clusters HDFS namespace. This is the same access/configuration required to support DISTCP for an HA environment and accounts for failovers.">linked</a> these two options provide a way to transfer data through an intermediate/common storage location. Each cluster must have access to these locations. These values are mutually exclusive.</p><p id="d0gna3_51"><code class="code" id="d0gna3_57">--intermediate-storage</code> requires an addition transfer of data. The LEFT transfers data to the <code class="code" id="d0gna3_58">-is</code> location and the RIGHT cluster uses that data and initiates a transfer from the location to the final hcfsNamespace value set for the cluster. This is a two copy migration.</p><figure id="d0gna3_52"><img alt="intermediate" src="images/intermediate.png" title="intermediate" width="680" height="546"></figure><p id="d0gna3_53"><code class="code" id="d0gna3_59">--common-storage</code> assumes the location is also the final resting place for the data. Some optimizations are possible (ACID downgrades) that reduce that times data need to move. This is a single copy migration.</p></section><section class="chapter"><h2 id="wd-warehouse-directory-and-ewd-external-warehouse-directory" data-toc="wd-warehouse-directory-and-ewd-external-warehouse-directory"><code class="code" id="d0gna3_62">-wd|--warehouse-directory</code> and <code class="code" id="d0gna3_63">-ewd|--external-warehouse-directory</code></h2><p id="d0gna3_61">Are used to set the <span class="emphasis" id="d0gna3_64">databases</span> default locations for managed and external tables. This overrides the systems <span class="emphasis" id="d0gna3_65">hive metastore</span> properties.</p></section><section class="chapter"><h2 id="rdl-reset-to-default-location" data-toc="rdl-reset-to-default-location"><code class="code" id="d0gna3_69">-rdl|--reset-to-default-location</code></h2><p id="d0gna3_67">Regardless of where the source data <span class="emphasis" id="d0gna3_70">relative</span> location was on the filesystem, this will reset it to the default location on the new cluster.</p><p id="d0gna3_68">If <code class="code" id="d0gna3_71">-dc|--distcp</code> is used, then the <code class="code" id="d0gna3_72">warehouse</code> options are required in order for <code class="code" id="d0gna3_73">hms-mirror</code> to build the <code class="code" id="d0gna3_74">distcp</code> workplan.</p></section><div class="last-modified">Last modified: 16 August 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="sql.html" class="navigation-links__prev">SQL</a><a href="export-import.html" class="navigation-links__next">EXPORT_IMPORT</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.js"></script></body></html>